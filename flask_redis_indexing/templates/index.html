<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Bruteforce Monitor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-dark text-light p-4">
<div class="container">
    <h1 class="mb-4">Bruteforce Monitor</h1>

    <h3>Последние попытки</h3>
    <table class="table table-sm table-dark table-striped">
        <thead>
        <tr>
            <th>Время</th>
            <th>Пользователь</th>
            <th>Пароль</th>
            <th>Успех</th>
            <th>Источник</th>
        </tr>
        </thead>
        <tbody id="log-table"></tbody>
    </table>
</div>

<script>
async function load() {
    const resp = await fetch("/attempts?limit=50");
    const data = await resp.json();
    let rows = "";

    for (const a of data.attempts) {
        let d = new Date(a.ts * 1000).toLocaleString();
        rows += `
            <tr>
                <td>${d}</td>
                <td>${a.username}</td>
                <td>${a.password}</td>
                <td>${a.success}</td>
                <td>${a.source}</td>
            </tr>`;
    }
    document.getElementById("log-table").innerHTML = rows;
}
load();
setInterval(load, 2000);
</script>
</body>
</html>

